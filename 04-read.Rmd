# データのあつかい方

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしてください！
1. [データの読み込み in R](https://youtu.be/FugazO_rL7c)  
1. [データフレームの操作 in R](https://youtu.be/96AZJmGNass)  


##### データフレーム{-}


多くのデータは、表形式でまとめられます。 縦方向に観測値を、横方向に変数を並べたデータのことをRではデータフレームと呼びます。

例として、年齢のベクトルage_vectorと性別のベクトルgender_vectorを合わせてデータフレームを作成してみましょう。 データフレームを作成する関数は`data.frame()`です。

```{r}
age <- c(18, 21, 22, 23, 34) #年齢のベクトルの作成
gender <- c("female", "male", "male", "female", "female") #性別のベクトルの作成
first_dataframe <- data.frame(age, gender)
first_dataframe
```

1人目が18歳の女性、2人目が21歳の男性…を表すデータフレームが作成できました。 後ほどExcelファイルなどからデータのRにインポートする方法を学びますが、その際は自動的にデータフレームとしてインポートされます。

データ分析の際に、データフレームのうち特定の変数だけを使いたい場合がよくあります。 その際は、データフレーム名$変数名と表記することで、特定の変数を使うことができます。 例えば、先ほど作成したfirst_dataframeから性別の変数のみを見てみましょう。

```{r}
first_dataframe$gender
```

性別のベクトルを取り出すことができました。 関数と組み合わせると、年齢の平均値を以下のように計算できます。

```{r}
mean(first_dataframe$age)

```

**練習問題**

- オブジェクトincomeに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- オブジェクトcityに文字列のベクトル"ibaraki", "takatsuki", "ibaraki", "takatsuki", "takatsuki"を代入してください。  
- incomeとcityを合わせたデータフレームincome_dataを作成してください。  
- income_dataを用いて、incomeの中央値を求めてください。

- データの読み込み

データ分析のためには、データをRStudioにインポート（読み込み）させなければなりません。インポートの方法は、持っているデータのファイル形式によって変わります。

## インポートの準備

インポートしたいファイルは、プロジェクトと同じフォルダに入れておきましょう。 プロジェクトはChapter 2で学習しています。

インポートしたいファイルの形式も確認しておきましょう。 代表的な形式として、CSVファイル（.csv）、Excelファイル（.xlsx, .xls）があります。 拡張子が表示されていない場合はこちらを参考に表示させるようにしましょう。

インポートの前に、ファイルの1行目は変数名（英語）にしておきましょう。

## インポート

### CSVファイルの場合（.csv）

CSVファイルの場合は、`read.csv`を用います。ファイルの名前がsotsuron.csvの場合、以下のように実行します。

```{r eval=FALSE}
data_original <- read.csv("sotsuron.csv")
```

これは、csvファイルの内容をdata_originalというオブジェクトに格納しています。 オブジェクト名は自由につけることができますが、わかりやすいものにしましょう。 ここでは、インポートした元データであることを明示するため、data_originalという名前にしています。

**練習問題**  
  
- 以下から「tidy_data.csv」をダウンロード
https://www.dropbox.com/s/wm46esg4dicye8j/tidy_data.csv?dl=0  
- `read.csv`を使って読み込み、dataというオブジェクトに格納


## インポートしたデータの確認

上の練習問題のデータがきちんとインポートされたかどうか、確認しておきましょう。

右上のペーンの“Environment”に新しいオブジェクトができているか確認（上の例ではdata）
クリックして左上のペーンに出てくるか確認
`head(data)`で先頭のデータを確認
`str(data)`で各変数の「型」（後で説明）を確認


