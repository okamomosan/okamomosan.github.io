--- 
title: "行動経済学の実証分析"
author: "Tomohisa OKADA"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This is a minimal example of using the bookdown package to write a book.
  The HTML output format for this example is bookdown::gitbook,
  set in the _output.yml file.
link-citations: yes
github-repo: rstudio/bookdown-demo
---

# Ready?

## R(Studio)とは？

- Rは、オープンソースで利用可能な統計解析に特化したプログラミング言語
- RStudioは、Rを使うための統合開発環境（なくてもRは使えるが、あるとめちゃ便利！）  
- 今は「まったく意味不明」で全然OK！

## Tips!

- Rに関するお役立ちサイトや書籍をまとめる

1. [「卒業論文のためのR入門」 by 森知晴先生](https://tomoecon.github.io/R_for_graduate_thesis/)  
Rの使い方と心理統計学の基礎が一挙に学べる！

1. [「私たちのR」 by 宋財泫先生 & 矢内勇生先生](https://www.jaysong.net/RBook/datahandling1.html)   
辞書的に使える！Tidyverseを使ったモダンなRのプログラムが学べる！

## R(Studio)のインストール

- 次のサイトにアクセス( https://posit.co/download/rstudio-desktop/ )
- 「1:Install R」からRをインストール
- 「2:Install RStudio」からRStudioをインストール
- うまくインストールできない場合は、[「私たちのR」]( https://www.jaysong.net/RBook/installation.html )に超詳しい解説がある

<!--chapter:end:index.Rmd-->

# Go!! 

- とりあえずまずは使ってみよう！

## RStudioを開く

- RStudioのアイコンから起動
- 次のような画面が表示される  
![](./img/01_rstudio_start.png)  

---

## コンソールに直接打ち込む

- 左側の大きな枠を見る  
- Consoleのタブが選択されていることを確認
- この画面（＝コンソール）を使い、簡単な足し算を実行しよう
- 最下段の`>`のあとに`1+1`と打ち込み**Enter（macはreturn）**を押す
- `[1] 2`と返ってくる
- `2`の部分が`1+1`の計算結果（`[1]`は1行目という意味）

<div align="center">
<img src="./img/01_betauchi.png" width="50%">
</div>

---

## Rスクリプトを使う

- コンソールに書いたコードは、Rstudioを終了すると消える  
（実際に終了して再起動してみよう）  
- だから、**Rスクリプト**と呼ばれる保存可能なファイルにコードを書くことが多い

##### Rスクリプトを作る：{-}
- RStudioの左上の <img src="./img/01_create.png" width="4%"> 
をクリックし、「R Script」を選択
- 左上に新しくできた枠に、空のRスクリプトファイルが表示される  
（untitled1と表示されたタブが作成したRスクリプト）


##### RStudioの４つのペーン：{-}
- 実際には、この４つの枠（＝ペーン）に分かれた画面で作業することが多い

![](./img/01_rstudio_4pane.png)  
  
  　　**①左上：**メインの作業場で、Rスクリプトのコードなどを書くところ  
  　　**②右上：**変数やオブジェクトのリストが表示されたり、バージョン管理を行う  
  　　**③左下：**コードの実行結果が表示されるコンソールや、各種コマンドを実行するターミナルなど  
  　　**④右下：**各種ファイルやパッケージの表示、出力した図の表示など  

#### Rスクリプトに書く：{-}
- 左上のペーンを見て、untitled1のタブが選択されていることを確認
- 1行目に`1+1`と入力して**ctrl+Enter（macはcommand+return）**を押す  
 （ <img src="./img/01_run.png" width="8%"> をクリックしても良い）
- 左下のペーンのコンソールに結果(`[1] 2`)が表示される

##### 保存：{-}

- Rスクリプトは**ctrl+s（macはcommand+s）**で好きな時に保存できる  
（ <img src="./img/01_save.png" width="2.5%"> をクリックしても良い）
- 初回はファイル名と保存場所も決める
（test.Rという名前でデスクトップに保存してみよう）
- 試しに、保存したRスクリプトのタブを閉じてみよう
（test.Rのタブの右側の×をクリック）
- 左上の <img src="./img/01_open.png" width="4%"> をクリックし、保存したRスクリプトのファイルを選択   
（つまり、デスクトップにあるtest.Rを選択）
- Rスクリプトが先ほど保存した状態で開く 
  
##### さらに書く！：{-}  

- 続けて、簡単な引き算を実行しよう
- 2行目に`5-2`と入力する
- 2行目にカーソルを合わせて**ctrl+Enter**を押す
- 2行目の計算結果(`[1] 3`)が表示される
- 1行目にカーソルを合わせて**ctrl+Enter**を押す
- 1行目の計算結果(`[1] 2`)が表示される
- つまり、実行したい行にカーソルを合わせて**ctrl+Enter**を押せば良い
- 全ての行を一括で実行したいなら**ctrl+shift+Enter（macはcommand+shift+return）**
- 一部分だけ実行したいなら、下図のように実行したい行だけ選択して**ctrl+Enter**  
  
<div align="center">
<img src="./img/01_ichibu.png" width="10%">
</div>  
  
##### Rスクリプトを使うメリット：{-}
1. コードが保存できる（毎回書き直さなくて良い！）
1. 長く複雑なコードを書いたり、管理するのが楽  
1. 他の人に配布できる（分析を再現してもらいやすい）  
などなど...

---

## プロジェクト管理  
  
- 研究プロジェクトが進むと、ひとつのRスクリプトだけでは管理しきれなくなる
- **プロジェクト**を使えば、複数のRスクリプトや関連データなどを一つのフォルダにまとめて効率よく管理できる

##### プロジェクトの作成： {-}

- 左上の <img src="./img/01_project1.png" width="3%"> をクリックし、「New Directry」→「New Project」の順に選択  
- 次の画面で<u>①プロジェクト名</u>と、その<u>②作成場所</u>を指定して<u>③「Create Project」</u>  
  
<div align="center">
<img src="./img/01_project2.png" width="45%">
</div>  

- 指定した場所に、指定したプロジェクト名のフォルダができているのを確認しよう
- そのフォルダの中に`プロジェクト名.Rproj`というファイルができているのを確認しよう
- 以下は、macで`Document`フォルダ内に`sugoi_project`というプロジェクトを作った例  
  
<div align="center">
<img src="./img/01_project3.png" width="45%">
</div>  
  
- 初めはご利益がわかりにくいが、研究プロジェクトごとにプロジェクトを作るクセをつけよう
- そして、次の心得に従い、プロジェクト上で作業をするようにしよう！

1. 毎回`プロジェクト名.Rproj`をダブルクリックしてRstudioを起動
1. 関連するファイルはプロジェクト名のフォルダにまとめて一元管理  


## 演習問題
- 自分の好きな場所に`zemi`という名前のプロジェクトを作る
- 指定した場所に`zemi`というフォルダができているのを確認する
- フォルダの中に`zemi.Rproj`というファイルが出来ているのを確認
  
<br>
**※ 今後は、この`zemi`プロジェクトで作業していることを前提に解説する**

<!--chapter:end:01-Go.Rmd-->

# 基本操作

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしてください！

1. [オブジェクトの使い方 in R](https://youtu.be/CblsIBlzqX0)  
1. [関数の使い方 in R](https://youtu.be/q8MI6P2hoUM)  

## 四則演算

**たし算:** `+`を使う  
```{r}
1 + 1
```

**ひき算:** `-`を使う  
```{r}
5 - 2
```

**かけ算:**  `*`を使う  
```{r}
4 * 5
```

**わり算:** `/`を使う（分数のイメージ）
```{r}
8 / 2
```

**累乗:** `^`か`**`を使う（例：$4^2$なら次のとおり）
```{r}
4 ^ 2
4 ** 2
```

---

## 変数とオブジェクト

- オブジェクトとは、色々なモノを入れる箱のようなもの[^1]  
- オブジェクトを変数という人もいる（数学の変数のようなイメージだから）
- 本資料では変数と呼ぶことにする（字数が少ないから）

- 次のコードを見てみよう

```{r}
x <- 1 # <- は左向矢印のイメージ

# このように#から始まる文章を書いてコメントを残せる
# これをコメントアウトと呼ぶ
# あとで見てわかりやすいような覚え書きなどを残そう
```

<div align="center">
<img src="./img/02_box.png" width="25%">
</div>  
  
- これはxという箱を作り、その中に数字の1を入れたイメージ  
（変数xに１を代入したイメージでもOK！）
- 上のコードを実行しても何も表示されないが、それでOK  
（「箱に入れる」だけのコードなので表示はされない）
- 変数の中身を確認したい時は、オブジェクトの名前を書いて実行

```{r}
x
```

- 数値を代入した変数同士で演算もできる

```{r}
y <- 1 
z <- 2
y * z # 1*2を計算したことになる
```

- 変数はいつでも上書きできる

```{r}

x <- 1 #xに1を代入
x

x <- 2 #xを2に上書き
x
```

- 計算結果を変数に代入することもできる

```{r}
x <- 2+5 
x # 計算結果の7が代入される
```

- 慣れるまでは不思議だが、こんなこともできる

```{r}
z <- 2 #zに2を代入
z <- z + 1 #z=2に1を足したものを、もう一度zに代入
z #新しいzを表示
```

- 変数には数値以外も入れることができる
- 例えば、mojiという変数を作り文字列を入れてみる

```{r}
# 文字列は"ダブルコーテーション"で囲む
# 'シングルコーテーション'でも良い
# 次のようにアルファベット以外も一応使えるが推奨しない

moji <- "岡田先生ステキ"
moji
```

---

## 関数①（数値に対する関数）

#### 関数のキホン：{-}

- Rにはさまざまな機能を実行できる関数が用意されている
- 例えば、平方根を計算する関数が`sqrt()`
- `()`の中に数値を入れると、その平方根を返してくれる

```{r}
sqrt(2)
```

- このように関数は`xxx()`のように最後が丸括弧になっている
- 丸括弧の中に、引数(ひきすう)と呼ばれる指定された形式の値を入れて実行する
- その結果、出力された値を戻り値という
- 先ほどの`sqrt(2)`なら`2`が引数で、計算結果の`1.414214`が戻り値  

#### 複数の引数を持つ関数：{-}  
  
- 引数は１つとは限らないので注意
- 例えば、`log()`は対数を計算する関数
- 次のようにすると、10の自然対数を返してくれる

```{r}
log(10)
```

- でも、2つ目の引数`base=10`を付け足すと、底が10の常用対数を返してくれる

```{r}
log(10, base = 10)
```
  
- 他にも、数え切れないほどの関数がある
  
#### 関数の機能や引数の調べ方：{-} 

- 関数の機能や、どんな形式の引数をいくつ持つかを調べるには`help()`を使う
- 知りたい関数から`()`を除いたものを、`help()`の中に入れる
- 例えば、`log()`について知りたいなら`help(log)`と書いて実行
- すると、Rstudioの右下（左下ではない！）のペーンに詳細が表示される

---

## ベクトルと行列

- Rでは、複数のデータの値をひとまとめにして扱いやすくできる

### ベクトル

- データを1列に並べたものをベクトルと呼ぶ
- ベクトルは関数`c()`を使って作る
- ベクトルも変数に入れることができる
- 例として、5つの数字（例えば、2,4,2,3,5）を並べたベクトルを変数`v`に代入する

```{r}
v <- c(2, 4, 2, 3, 5) #ベクトルを作り変数に代入
v #変数vの中身を確認
```

- 連番のベクトル（例えば2,3,4,5,6）を作りたい時は、次のようにも書ける

```{r}
v <- c(2:6) #「n:m」で「nからmまで」の意味
v
```


#### ベクトルと数値の演算： {-} 

- ベクトルにも四則演算の記号（=演算子）を使った演算ができる
- ベクトル内のそれぞれの数字に、四則演算が施される
- 以下の出力結果で確認してみよう

```{r}
  
v+2  #それぞれの数字に２を足す 
2*v  #それぞれの数字に２をかける  

```

##### 練習問題 {-} 
- 上の`v`について、`v-2`、`v/2`、`v^2`の実行結果を確認する

#### ベクトル同士の演算： {-} 

- Rでは、ベクトル同士の演算もできる
- まずは2つのベクトルを用意しよう

```{r}
v1 <- c(1, 2) 
v2 <- c(2, 4) 
```

- これらを`+`を使って「足す」
- すると、１つめの数同士（1と2）と、２つめの数同士(2と4)が足される

```{r}
v1 + v2
```

- `*`を使って「かける」場合も、同じように1つめの数同士、2つめの数同士がかけられる

```{r}
v1 * v2
```

- ベクトル同士の「かけ算」には内積がある
- Rでは、`%*%`で内積を計算できる

```{r}
v1 %*% v2 
```

- ベクトルの長さ（=入っている数値の個数）が違うとおかしな計算になり、警告が出る

```{r}
#以下のv1には3つの要素があるけど、v2には2つしかない
#この場合、v2の1つめの要素を無理やりv1の３つめに足してしまう

v1 <- c(1, 2, 3)  #3つの数を代入
v2 <- c(2, 4) #2つの数を代入
v1 + v2 #長さが違うからうまく計算できず警告が出る
```

##### 練習問題 {-} 
- 上の`v1`と`v2`を使い、`-`、`/`、`^`の３つの演算を行う
- いずれも1つめの数値同士、2つめの数値同士で対応した演算がなされることを確かめる

#### 要素の抽出：{-} 

- ベクトルから、任意の要素（`n`番目の数）を抽出する方法を説明する
- `x`という名前のベクトルからn番目の要素を抽出する時は`x[n]`
- 具体例として、先ほどのベクトル`v=c(2,4,2,3,5)`で考える
- 2番目の要素（つまり4）を抜き出したいなら、`v[2]`と書く

```{r}
v[2]
```

- 2〜４番めの要素(つまり4,2,3)を抜き出したいなら、`v[2:4]`と書く

```{r}
v[2:4]
```


### 行列

#### 行列のキホン：{-}

- データを行と列の2次元に並べたものを行列と呼ぶ
- 例えば、2行3列の行列\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
\end{pmatrix}を作ってMに代入するには、`matrix()`を使い次のように書く

```{r}
#初めの1:6はc(1:6)と同じで「1,2,3,4,5,6」の意味
#この6つの数字を、2つの行(row)と3つの列(col)に分ける
#byrow = Tで、6つの数字を左から右（zの書き順）に埋めるよう指示
#byrow = Tを消すと、上から下に埋める（各自確かめよう）

M <- matrix(1:6, nrow = 2, ncol = 3, byrow = T)
M
```

- 次の関数を使って、ベクトル同士を結合しても行列を作れる

```{r}
v1 <- c(1,2,3) 
v2 <- c(1,1,1) #2つのベクトルv1とv2を作る

rbind(v1, v2) #v1とv2を行(row)方向に繋げる
cbind(v1, v2) #v1とv2を列(column)方向に繋げる

rbind(M, v1) #「行列とベクトル」や「行列同士」も繋げられる
```

#### 要素の抽出：{-}

- 行列`x`から要素を抜き出すには、` x[抜き出したい行、抜き出したい列]`と書く
- 具体例として、先の行列`M`から色々な要素を抜き出してみよう

```{r}
# 2行1列目を抽出し、変数M21に代入
M21 <- M[2,1]

# 2行めを抽出
M[2,]

# 1列めを抽出
M[,1]

# 1,2行めと1,3列めを抽出
M[c(1,2),c(1,3)]

```

#### 行列の演算：{-}
- n行n列の２つの行列同士の計算について、足し算は`+`、引き算は`-`を使えば良い
- 以下の例のように、かけ算は`%*%`を使わなくてはいけないので注意

```{r}

M #先ほど作った2行3列の行列を表示
 
M2 <- matrix(c(1,2,0,1,0,2), nrow = 3, ncol = 2, byrow = T) #新たに3行2列の行列を作る
M2 #今作った2行3列の行列を表示

#２つの行列の積MN
M %*% M2 

#２つの行列の積MN
M2 %*% M　

v <- c(1,2,3) #要素が３つのベクトルを作る

#行列とベクトルのかけ算も%*%を使う
#縦ベクトルと横ベクトルは区別されないので、次のコードで計算できる
v %*% M2 # ただし、M2%*%vのように計算できない場合はエラーが出る（各自確かめよう）


```

---

## 関数②（ベクトルや行列に対する関数）

- 先の`rbind()`や`cbind()`はベクトルや行列も引数にとれる関数だった
- ベクトルや行列に対して使える他の関数をいくつか紹介する

#### ベクトルの頻出関数：{-}

- 以下の関数はどれもよく使うので、しっかり覚えよう

|関数(引数xはベクトル)|意味|
|:----|:----|
|summary(x)|基本統計量の一括表示|
|max(x)|xの要素の最大値|
|min(x)|xの要素の最小値|
|mean(x)|xの平均値|
|median(x)|xの中央値|
|var(x)|xの不偏分散|
|sd(x)|xの不偏標準偏差|
|sum(x)|xの各要素の総和|
|range(x)|xのデータの範囲（最小値と最大値）|
|length(x)|xのデータの個数（ベクトルの次元）|
|sort(x)|xの各要素を小さい順に並び替え|
|sort(x, decreasing = TRUE)|xの各要素を大きい順に並び替え|  

  
- 具体的に理解するため、5人の年齢のデータを作成する

```{r}
age <- c(36, 16, 43, 18, 22) #5人の年齢のベクトルを作成
```

- このベクトル`age`を引数にして、上表のいくつかを実行してみる

```{r}

summary(age) #基本統計量を一括表示

max(age) #一番大きい値を取り出す（5人のうち最年長は43歳）

mean(age) #算術平均（5人の平均年齢は27歳）

var(age) #不偏分散（5人の平均の分散は141）

length(age) #データの長さ（ベクトルの次元）（5個のデータなので5）

```

##### 練習問題 {-} 
- 引数を`age`にして、`min()`, `median()`,`sd()`,`sum()`,`range()`,`sort()`を実行する
- 各々の結果が何を意味しているのかを解釈する
- 引数を行列`M`にして、上表の各関数の結果を確認する

#### 行列の頻出関数： {-}

- 行列を引数に持つ関数のうち、比較的よく使うものをまとめる
- どのような結果になるかは各自確かめてみよう

|関数(引数xは行列)|意味|
|:----|:----|
|matrix(0, nrow=2, ncol=3) |2 行 3 列のゼロ行列を作成|
|diag(5)|5×5の単位行列作成|
|diag(X) <- 1|行列 X の対角成分を全て 1 にする|
|t(X)|行列 X の転置行列|
|solve(X)|行列 X の逆行列|
|det(X)|行列 X の行列式|
|rowSums(X)|行列 X の行和|
|colSums(X)|行列 X の列和|
|RowMeans(X)|行列 X の行平均|
|colMeand(X)|行列 X の列平均|

##### 練習問題 {-} 
- 上の各関数を先の行列`M`に使い、結果を確かめよう

---

## 演習問題 

- オブジェクトincome_vectorに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- income_vectorの平均・中央値・標準偏差をそれぞれ求めてください。  

**練習問題**

- third_objectという名前のオブジェクトに10000を代入し、確認してください。  
- my_nameという名前のオブジェクトにあなたの名前（文字列）を代入し、確認してください。  
- second_vector_objectという名前のオブジェクトに数値のベクトル1, 1, 2, 3, 5, 8を代入し、確認してください。  
**練習問題**

- オブジェクトaに3を、オブジェクトbに4を代入してください。
- a, bそれぞれを2乗したものの和をとり、結果が25となることを確認してください。

**練習問題**

- オブジェクトaに3を、オブジェクトbに4を代入してください。（前の問題と同様）  
- a, bそれぞれの2乗して和をとったものの平方根をとり、結果が5となることを確認してください。  
ヒント：前の問題の計算全体をsqrt()のかっこでくくってください。
### ベクトルに対する関数
  


[^1]: 厳密にはRで出てくるあらゆるモノはオブジェクトだが、ここでは深く踏みこまない

<!--chapter:end:02-kihon.Rmd-->

# パッケージ

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしてください！


## パッケージとは？

## パッケージのインストール


多くのデータは、表形式でまとめられます。 縦方向に観測値を、横方向に変数を並べたデータのことをRではデータフレームと呼びます。

例として、年齢のベクトルage_vectorと性別のベクトルgender_vectorを合わせてデータフレームを作成してみましょう。 データフレームを作成する関数は`data.frame()`です。

```{r}
age <- c(18, 21, 22, 23, 34) #年齢のベクトルの作成
gender <- c("female", "male", "male", "female", "female") #性別のベクトルの作成
first_dataframe <- data.frame(age, gender)
first_dataframe
```

1人目が18歳の女性、2人目が21歳の男性…を表すデータフレームが作成できました。 後ほどExcelファイルなどからデータのRにインポートする方法を学びますが、その際は自動的にデータフレームとしてインポートされます。

データ分析の際に、データフレームのうち特定の変数だけを使いたい場合がよくあります。 その際は、データフレーム名$変数名と表記することで、特定の変数を使うことができます。 例えば、先ほど作成したfirst_dataframeから性別の変数のみを見てみましょう。

```{r}
first_dataframe$gender
```

性別のベクトルを取り出すことができました。 関数と組み合わせると、年齢の平均値を以下のように計算できます。

```{r}
mean(first_dataframe$age)

```

**練習問題**

- オブジェクトincomeに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- オブジェクトcityに文字列のベクトル"ibaraki", "takatsuki", "ibaraki", "takatsuki", "takatsuki"を代入してください。  
- incomeとcityを合わせたデータフレームincome_dataを作成してください。  
- income_dataを用いて、incomeの中央値を求めてください。

- データの読み込み

データ分析のためには、データをRStudioにインポート（読み込み）させなければなりません。インポートの方法は、持っているデータのファイル形式によって変わります。

## インポートの準備

インポートしたいファイルは、プロジェクトと同じフォルダに入れておきましょう。 プロジェクトはChapter 2で学習しています。

インポートしたいファイルの形式も確認しておきましょう。 代表的な形式として、CSVファイル（.csv）、Excelファイル（.xlsx, .xls）があります。 拡張子が表示されていない場合はこちらを参考に表示させるようにしましょう。

インポートの前に、ファイルの1行目は変数名（英語）にしておきましょう。

## インポート

### CSVファイルの場合（.csv）

CSVファイルの場合は、`read.csv`を用います。ファイルの名前がsotsuron.csvの場合、以下のように実行します。

```{r eval=FALSE}
data_original <- read.csv("sotsuron.csv")
```

これは、csvファイルの内容をdata_originalというオブジェクトに格納しています。 オブジェクト名は自由につけることができますが、わかりやすいものにしましょう。 ここでは、インポートした元データであることを明示するため、data_originalという名前にしています。

**練習問題**  
  
- 以下から「tidy_data.csv」をダウンロード
https://www.dropbox.com/s/wm46esg4dicye8j/tidy_data.csv?dl=0  
- `read.csv`を使って読み込み、dataというオブジェクトに格納


## インポートしたデータの確認

上の練習問題のデータがきちんとインポートされたかどうか、確認しておきましょう。

右上のペーンの“Environment”に新しいオブジェクトができているか確認（上の例ではdata）
クリックして左上のペーンに出てくるか確認
`head(data)`で先頭のデータを確認
`str(data)`で各変数の「型」（後で説明）を確認



<!--chapter:end:03-package.Rmd-->

# データのあつかい方

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしてください！
1. [データの読み込み in R](https://youtu.be/FugazO_rL7c)  
1. [データフレームの操作 in R](https://youtu.be/96AZJmGNass)  


##### データフレーム{-}


多くのデータは、表形式でまとめられます。 縦方向に観測値を、横方向に変数を並べたデータのことをRではデータフレームと呼びます。

例として、年齢のベクトルage_vectorと性別のベクトルgender_vectorを合わせてデータフレームを作成してみましょう。 データフレームを作成する関数は`data.frame()`です。

```{r}
age <- c(18, 21, 22, 23, 34) #年齢のベクトルの作成
gender <- c("female", "male", "male", "female", "female") #性別のベクトルの作成
first_dataframe <- data.frame(age, gender)
first_dataframe
```

1人目が18歳の女性、2人目が21歳の男性…を表すデータフレームが作成できました。 後ほどExcelファイルなどからデータのRにインポートする方法を学びますが、その際は自動的にデータフレームとしてインポートされます。

データ分析の際に、データフレームのうち特定の変数だけを使いたい場合がよくあります。 その際は、データフレーム名$変数名と表記することで、特定の変数を使うことができます。 例えば、先ほど作成したfirst_dataframeから性別の変数のみを見てみましょう。

```{r}
first_dataframe$gender
```

性別のベクトルを取り出すことができました。 関数と組み合わせると、年齢の平均値を以下のように計算できます。

```{r}
mean(first_dataframe$age)

```

**練習問題**

- オブジェクトincomeに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- オブジェクトcityに文字列のベクトル"ibaraki", "takatsuki", "ibaraki", "takatsuki", "takatsuki"を代入してください。  
- incomeとcityを合わせたデータフレームincome_dataを作成してください。  
- income_dataを用いて、incomeの中央値を求めてください。

- データの読み込み

データ分析のためには、データをRStudioにインポート（読み込み）させなければなりません。インポートの方法は、持っているデータのファイル形式によって変わります。

## インポートの準備

インポートしたいファイルは、プロジェクトと同じフォルダに入れておきましょう。 プロジェクトはChapter 2で学習しています。

インポートしたいファイルの形式も確認しておきましょう。 代表的な形式として、CSVファイル（.csv）、Excelファイル（.xlsx, .xls）があります。 拡張子が表示されていない場合はこちらを参考に表示させるようにしましょう。

インポートの前に、ファイルの1行目は変数名（英語）にしておきましょう。

## インポート

### CSVファイルの場合（.csv）

CSVファイルの場合は、`read.csv`を用います。ファイルの名前がsotsuron.csvの場合、以下のように実行します。

```{r eval=FALSE}
data_original <- read.csv("sotsuron.csv")
```

これは、csvファイルの内容をdata_originalというオブジェクトに格納しています。 オブジェクト名は自由につけることができますが、わかりやすいものにしましょう。 ここでは、インポートした元データであることを明示するため、data_originalという名前にしています。

**練習問題**  
  
- 以下から「tidy_data.csv」をダウンロード
https://www.dropbox.com/s/wm46esg4dicye8j/tidy_data.csv?dl=0  
- `read.csv`を使って読み込み、dataというオブジェクトに格納


## インポートしたデータの確認

上の練習問題のデータがきちんとインポートされたかどうか、確認しておきましょう。

右上のペーンの“Environment”に新しいオブジェクトができているか確認（上の例ではdata）
クリックして左上のペーンに出てくるか確認
`head(data)`で先頭のデータを確認
`str(data)`で各変数の「型」（後で説明）を確認



<!--chapter:end:04-read.Rmd-->

