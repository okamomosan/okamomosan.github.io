# 基本操作

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしてください！

1. [オブジェクトの使い方 in R](https://youtu.be/CblsIBlzqX0)  
1. [関数の使い方 in R](https://youtu.be/q8MI6P2hoUM)  

## 四則演算

**たし算:** `+`を使う  
```{r}
1 + 1
```

**ひき算:** `-`を使う  
```{r}
5 - 2
```

**かけ算:**  `*`を使う  
```{r}
4 * 5
```

**わり算:** `/`を使う（分数のイメージ）
```{r}
8 / 2
```

**累乗:** `^`か`**`を使う（例：$4^2$なら次のとおり）
```{r}
4 ^ 2
4 ** 2
```

## 変数とオブジェクト

- オブジェクトとは、色々なモノを入れる箱のようなもの[^1]  
- オブジェクトを変数という人もいる（数学の変数のようなイメージだから）
- 本資料では変数と呼ぶことにする（字数が少ないから）

- 次のコードを見てみよう

```{r}
x <- 1 # <- は左向矢印のイメージ

# このように#から始まる文章を書いてコメントを残せる
# これをコメントアウトと呼ぶ
# あとで見てわかりやすいような覚え書きなどを残そう
```

<div align="center">
<img src="./img/02_box.png" width="25%">
</div>  
  
- これはxという箱を作り、その中に数字の1を入れたイメージ  
（変数xに１を代入したイメージでもOK！）
- 上のコードを実行しても何も表示されないが、それでOK  
（「箱に入れる」だけのコードなので表示はされない）
- 変数の中身を確認したい時は、オブジェクトの名前を書いて実行

```{r}
x
```

- 数値を代入した変数同士で演算もできる

```{r}
y <- 1 
z <- 2
y * z # 1*2を計算したことになる
```

- 変数はいつでも上書きできる

```{r}

x <- 1 #xに1を代入
x

x <- 2 #xを2に上書き
x
```

- 慣れるまでは不思議だが、こんなこともできる

```{r}
z <- 2 #zに2を代入
z <- z + 1 #z=2に1を足したものを、もう一度zに代入
z #新しいzを
```

- 変数には数値以外も入れることができる
- 例えば、mojiという変数を作り文字列を入れてみる

```{r}
# 文字列は"ダブルコーテーション"で囲む
# 'シングルコーテーション'でも良い
# 次のようにアルファベット以外も一応使えるが推奨しない

moji <- "岡田先生ステキ"
moji
```

## 関数①（数値に対する関数）

#### 関数のキホン：{-}

- Rにはさまざまな機能を実行できる関数が用意されている
- 例えば、平方根を計算する関数が`sqrt()`
- `()`の中に数値を入れると、その平方根を返してくれる

```{r}
sqrt(2)
```

- このように関数は`xxx()`のように最後が丸括弧になっている
- 丸括弧の中に、引数(ひきすう)と呼ばれる指定された形式の値を入れて実行する
- その結果、出力された値を戻り値という
- 先ほどの`sqrt(2)`なら`2`が引数で、計算結果の`1.414214`が戻り値  

#### 複数の引数を持つ関数：{-}  
  
- 引数は１つとは限らないので注意
- 例えば、`log()`は対数を計算する関数
- 次のようにすると、10の自然対数を返してくれる

```{r}
log(10)
```

- でも、2つ目の引数`base=10`を付け足すと、底が10の常用対数を返してくれる

```{r}
log(10, base = 10)
```
  
- 他にも、数え切れないほどの関数がある
  
#### 関数の機能や引数の調べ方：{-} 

- 関数の機能や、どんな形式の引数をいくつ持つかを調べるには`help()`を使う
- 知りたい関数から`()`を除いたものを、`help()`の中に入れる
- 例えば、`log()`について知りたいなら`help(log)`と書いて実行
- すると、Rstudioの右下（左下ではない！）のペーンに詳細が表示される


## ベクトルと行列

- Rでは、複数のデータの値をひとまとめにして扱いやすくできる

### ベクトル

- データを1列に並べたものをベクトルと呼ぶ
- ベクトルは関数`c()`を使って作る
- ベクトルも変数に入れることができる
- 例として、5つの数字（例えば、2,4,2,3,5）を並べたベクトルを変数`v`に代入する

```{r}
v <- c(2, 4, 2, 3, 5) #ベクトルを作り変数に代入
v #変数vの中身を確認
```

- 連番のベクトル（例えば2,3,4,5,6）を作りたい時は、次のようにも書ける

```{r}
v <- c(2:6) #「n:m」で「nからmまで」の意味
v
```


#### ベクトルと数値の演算： {-} 

- ベクトルにも四則演算の記号（=演算子）を使った演算ができる
- ベクトル内のそれぞれの数字に、四則演算が施される
- 以下の出力結果で確認してみよう

```{r}
  
v+2  #それぞれの数字に２を足す 
2*v  #それぞれの数字に２をかける  

```

##### 練習問題 {-} 
- 上の`v`について、`v-2`、`v/2`、`v^2`の実行結果を確認する

#### ベクトル同士の演算： {-} 

- Rでは、ベクトル同士の演算もできる
- まずは2つのベクトルを用意しよう

```{r}
v1 <- c(1, 2) 
v2 <- c(2, 4) 
```

- これらを`+`を使って「足す」
- すると、１つめの数同士（1と2）と、２つめの数同士(2と4)が足される

```{r}
v1 + v2
```

- `*`を使って「かける」場合も、同じように1つめの数同士、2つめの数同士がかけられる

```{r}
v1 * v2
```

- ベクトル同士の「かけ算」には内積がある
- Rでは、`%*%`で内積を計算できる

```{r}
v1 %*% v2 
```

- ベクトルの長さ（=入っている数値の個数）が違うとおかしな計算になり、警告が出る

```{r}
#以下のv1には3つの要素があるけど、v2には2つしかない
#この場合、v2の1つめの要素を無理やりv1の３つめに足してしまう

v1 <- c(1, 2, 3)  #3つの数を代入
v2 <- c(2, 4) #2つの数を代入
v1 + v2 #長さが違うからうまく計算できず警告が出る
```

##### 練習問題 {-} 
- 上の`v1`と`v2`を使い、`-`、`/`、`^`の３つの演算を行う
- いずれも1つめの数値同士、2つめの数値同士で対応した演算がなされることを確かめる

#### 要素の抽出：{-} 

- ベクトルから、任意の要素（`n`番目の数）を抽出する方法を説明する
- `x`という名前のベクトルからn番目の要素を抽出する時は`x[n]`
- 具体例として、先ほどのベクトル`v=c(2,4,2,3,5)`で考える
- 2番目の要素（つまり4）を抜き出したいなら、`v[2]`と書く

```{r}
v[2]
```

- 2〜４番めの要素(つまり4,2,3)を抜き出したいなら、`v[2:4]`と書く

```{r}
v[2:4]
```


### 行列

- データを行と列の2次元に並べたものを行列と呼ぶ
- 例えば、2行3列の行列\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
\end{pmatrix}を作ってMに代入するには、`matrix()`を使い次のように書く

```{r}
#初めの1:6はc(1:6)と同じで「1,2,3,4,5,6」の意味
#この6つの数字を、2つの行(row)と3つの列(col)に分ける
#byrow = Tで、6つの数字を左から右（zの書き順）に埋めるよう指示
#byrow = Tを消すと、上から下に埋める（各自確かめよう）

M <- matrix(1:6, nrow = 2, ncol = 3, byrow = T)
M
```





オブジェクトに入れるものは1つの値ではなく、複数の値にすることもできます。 複数の値を並べたものは「ベクトル」と呼ばれます。 ベクトルはc()でまとめます。

```{r}
first_vector_object <- c(1, 2, 3, 4, 5)
first_vector_object
```

ここでは、first_vector_objectというオブジェクトに、1から5までの数値を代入しています。 文字列のベクトルも作ることができるので、試してみてください。

ここまでは数値同士で計算させていましたが、数値を代入したオブジェクトも使うことができます。例えば、`age’に年齢を代入しておき、10年後の年齢を計算させてみましょう。

**練習問題**

- third_objectという名前のオブジェクトに10000を代入し、確認してください。  
- my_nameという名前のオブジェクトにあなたの名前（文字列）を代入し、確認してください。  
- second_vector_objectという名前のオブジェクトに数値のベクトル1, 1, 2, 3, 5, 8を代入し、確認してください。  



```{r}
age <- 20
age + 10
```

ここまでは計算結果を単に表示させていました。計算結果をオブジェクトに代入することもできます。 例えば、1 + 1の結果をone_plus_oneというオブジェクトに代入してみましょう。

```{r}
one_plus_one <- 1 + 1
one_plus_one
```

オブジェクトone_plus_oneには計算結果2が代入されています。

**練習問題**

- オブジェクトaに3を、オブジェクトbに4を代入してください。
- a, bそれぞれを2乗したものの和をとり、結果が25となることを確認してください。

5.3 関数

Rではオブジェクトから別のオブジェクトを生成するために「関数（function）」を用います。 関数の使い方に慣れていきましょう。 関数は関数名(引数)という構造で使います。 引数（argument）は「ひきすう」と読みます。

ここでは、簡単な関数の例を紹介します。 その他の関数はその都度紹介します。

### 数値に対する関数

皆さんが数学で勉強してきた関数をRの関数として使うことができます。例えば平方根をとる関数sqrt()を使ってみましょう。

```{r}
sqrt(4)
```

ここでは、sqrt()が関数、引数は4です。4の平方根をとった結果として2が表示されています。他の数式として例えば自然対数をとるlog()があります。

**練習問題**

- オブジェクトaに3を、オブジェクトbに4を代入してください。（前の問題と同様）  
- a, bそれぞれの2乗して和をとったものの平方根をとり、結果が5となることを確認してください。  
ヒント：前の問題の計算全体をsqrt()のかっこでくくってください。

### ベクトルに対する関数

関数の引数は数値だけでなく、ベクトルをとることもできます。統計分析ではこちらをよく使います。例えば、年齢のデータが入ったベクトル`age_vector <- c(18, 21, 22, 23, 34)`を考えます。

例えば、ベクトルの最小値を取り出す`min()`を使ってみましょう。

```{r}
age_vector <- c(18, 21, 22, 23, 34)
min(age_vector)
```

一番年齢が若い人が18歳であることが確認できます。最大値を取り出すのは`max()`です。

心理学統計法で学んだ平均・標準偏差などの統計量も計算することができます。平均は`mean()`、中央値は`median()`、（不偏）標準偏差は`sd()`を使います。

```{r}
mean(age_vector)
```

```{r}
median(age_vector)
```

```{r}
sd(age_vector)
```

**練習問題**

- オブジェクトincome_vectorに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- income_vectorの平均・中央値・標準偏差をそれぞれ求めてください。  
  
## データフレーム

多くのデータは、表形式でまとめられます。 縦方向に観測値を、横方向に変数を並べたデータのことをRではデータフレームと呼びます。

例として、年齢のベクトルage_vectorと性別のベクトルgender_vectorを合わせてデータフレームを作成してみましょう。 データフレームを作成する関数は`data.frame()`です。

```{r}
age <- c(18, 21, 22, 23, 34) #年齢のベクトルの作成
gender <- c("female", "male", "male", "female", "female") #性別のベクトルの作成
first_dataframe <- data.frame(age, gender)
first_dataframe
```

1人目が18歳の女性、2人目が21歳の男性…を表すデータフレームが作成できました。 後ほどExcelファイルなどからデータのRにインポートする方法を学びますが、その際は自動的にデータフレームとしてインポートされます。

データ分析の際に、データフレームのうち特定の変数だけを使いたい場合がよくあります。 その際は、データフレーム名$変数名と表記することで、特定の変数を使うことができます。 例えば、先ほど作成したfirst_dataframeから性別の変数のみを見てみましょう。

```{r}
first_dataframe$gender
```

性別のベクトルを取り出すことができました。 関数と組み合わせると、年齢の平均値を以下のように計算できます。

```{r}
mean(first_dataframe$age)

```

**練習問題**

- オブジェクトincomeに数値のベクトル10, 100, 1000, 10000, 100000を代入してください。  
- オブジェクトcityに文字列のベクトル"ibaraki", "takatsuki", "ibaraki", "takatsuki", "takatsuki"を代入してください。  
- incomeとcityを合わせたデータフレームincome_dataを作成してください。  
- income_dataを用いて、incomeの中央値を求めてください。


[^1]: 厳密にはRで出てくるあらゆるモノはオブジェクトだが、ここでは深く踏みこまない
