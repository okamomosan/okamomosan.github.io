# 関数の自作とパッケージ

- 本章の説明がわからない人は、第１章で紹介した[「私たちのR」](https://www.jaysong.net/RBook/datahandling1.html) を参照しよう！

## 関数の自作

**本節は少し難しいのでスキップしてもOK **  
  
- Rには、第３章で紹介した以外にもたくさんの関数が用意されている
- でも、既存関数を駆使しても、長く煩雑なコードでしか処理できないことも多い
- そのようなコーディングを繰り返し実行しなければいけない時は、自作関数を作ると便利
- 自作関数の作り方の基本は以下のとおり

```{r eval = FALSE}
関数名 <- function (引数名) {
  処理内容
}
```

- 例えば、$a/(1-x)$という計算を、様々な`a`と`x`の値で繰り返し実行する必要があるとする
- この計算を実行する関数`inf_geo()`は、次のように自作できる

```{r}
inf_geo <- function (a, x) {
  a/(1-x)
}
```

- 出来上がった関数を使うときは、次のようにする

```{r}
#a=1で、x=0.8を計算したい場合
inf_geo(1, 0.8)
```



## パッケージとは？

- 実は、よく使う分析や処理の関数は既に誰かが作って公開していることが多い
- 誰かが作った便利な自作関数が配布用にまとめられたものをパッケージという
- パッケージは、Rの機能を拡張しパワーアップさせる道具箱のイメージ

## パッケージのインストール

- 数えきれないパッケージの中から、自分に合うものを適宜インストールして利用できる
- インストール方法は、引数をインストールしたいパッケージ名にして`install.packages()`を実行
- 例えば、`tidyverse`というパッケージは、次のようにインストールする[^1]
- **この`tidyverse`を導入することでRが化ける！**（詳しい使い方は次章）

```{r eval=FALSE}
# 初回に一度だけ実行
install.packages("tidyverse") #引数の"ダブルコーテーション"を忘れない
```

- インストールするだけでは使えない、次のコードを実行して初めて`tidyverse`が使えるようになる

```{r eval=FALSE}
# RStudioを起動する度に実行
library(tidyverse) #引数の"ダブルコーテーション"は不要
```

- `install.packages()`は、初回に一度だけ実行すれば良い
- ただし、`library()`はRstudioを起動するたびに実行する必要がある
- そのため、Rスクリプトの最初に分析で使う`library(パッケージ名)`を並べておくと良い


[^1]: tidyverseは複数の便利なパッケージをまとめた「パッケージのパッケージ」