# 基本操作①

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしよう！

1. [オブジェクトの使い方 in R](https://youtu.be/CblsIBlzqX0)  
1. [関数の使い方 in R](https://youtu.be/q8MI6P2hoUM)  

- データ型やデータ構造については、逆瀬川浩孝先生のホームページを参照

　 [「経営工学雑記帖」内のRのページ](http://www.f.waseda.jp/sakas/R/index.html)

## 四則演算

**たし算:** `+`を使う  
```{r}
1 + 1
```

**ひき算:** `-`を使う  
```{r}
5 - 2
```

**かけ算:**  `*`を使う  
```{r}
4 * 5
```

**わり算:** `/`を使う（分数のイメージ）
```{r}
8 / 2
```

**累乗:** `^`か`**`を使う（例：$4^2$なら次のとおり）
```{r}
4 ^ 2
4 ** 2
```

- 例えば、9÷2の答えは「4余り1」
- この時、４を整数の商、1を剰余という

**整数の商:** `%/%`
```{r}
9%/%2
```

**剰余（mod）:** `%%`
```{r}
9%%2
```

---

## 変数（オブジェクト）

- オブジェクトとは、色々なモノを入れる箱のようなもの[^1]  
- オブジェクトを変数という人もいる（数学の変数のようなイメージだから）
- 本資料では変数と呼ぶことにする（字数が少ないから）

- 次のコードを見てみよう

```{r}
x <- 1 # <- は左向矢印のイメージ

# このように#から始まる文章を書いてコメントを残せる
# これをコメントアウトと呼ぶ
# あとで見てわかりやすいような覚え書きなどを残そう
```

<div align="center">
<img src="./img/02_box.png" width="25%">
</div>  
  
- これはxという箱を作り、その中に数字の1を入れたイメージ  
（変数xに１を代入したイメージでもOK！）
- 上のコードを実行しても何も表示されないが、それでOK  
（「箱に入れる」だけのコードなので表示はされない）
- 変数の中身を確認したい時は、オブジェクトの名前を書いて実行

```{r}
x
```

- 数値を代入した変数同士で演算もできる

```{r}
y <- 1 
z <- 2
y * z # 1*2を計算したことになる
```

- 変数はいつでも上書きできる

```{r}

x <- 1 #xに1を代入
x

x <- 2 #xを2に上書き
x
```

- 計算結果を変数に代入することもできる

```{r}
x <- 2+5 
x # 計算結果の7が代入される
```

- 慣れるまでは不思議だが、こんなこともできる
- 意外とよく使うので、頭の片隅に留めておこう

```{r}
suuji <- 2 #suujiに2を代入
suuji <- suuji + 1 #suuji=2に1を足したものを、もう一度suujiに代入
suuji #新しいsuujiを表示
```

- 変数には数値以外も入れることができる
- 例えば、mojiという変数を作り文字列を入れてみる


```{r}
# 文字列は"ダブルコーテーション"で囲む
# 'シングルコーテーション'でも良い
# 次のようにアルファベット以外も一応使えるが推奨しない

moji <- "岡田先生ステキ"
moji
```

##### 練習問題 {-}  
- 変数xに3、変数yに6を代入する
- xとyをそれぞれ2乗して和をとり、結果が45となることを確認する

---

## 関数①（数値に対する関数）

#### 関数のキホン：{-}

- Rにはさまざまな機能を実行できる関数が用意されている
- 例えば、平方根を計算する関数が`sqrt()`
- `()`の中に数値を入れると、その平方根を返してくれる

```{r}
sqrt(2)
```

- このように関数は`xxx()`のように最後が丸括弧になっている
- 丸括弧の中に、引数(ひきすう)と呼ばれる指定された形式の値を入れて実行する
- その結果、出力された値を戻り値という
- 先ほどの`sqrt(2)`なら`2`が引数で、計算結果の`1.414214`が戻り値  

#### 複数の引数を持つ関数：{-}  
  
- 引数は１つとは限らないので注意
- 例えば、`log()`は対数を計算する関数
- 次のようにすると、10の自然対数を返してくれる

```{r}
log(10)
```

- でも、2つ目の引数`base=10`を付け足すと、底が10の常用対数を返してくれる

```{r}
log(10, base = 10)
```
  
- 数値(numeric型)を引数にする関数のうち、よく使うものを列挙する

|関数(引数xは数値)|意味|
|:----|:----|
|log(x)|自然対数|
|log(x, base=y)|yを底とする常用対数|
|sqrt(x)|xの平方根|
|exp(x)|x指数関数（$e^x$)）|
|abs(x)|xの絶対値|
|round(x,y)|小数点以下y桁になるようxを四捨五入<br>（IEEE754方式）※ 詳細は演習問題参照 |
|floor(x)|xの小数点以下切り捨て|
|ceiling(x)|xの小数点以下切り上げ|  

- 他にも、数え切れないほどの関数がある
  
#### 関数の機能や引数の調べ方：{-} 

- 関数の機能や、どんな形式の引数をいくつ持つかを調べるには`help()`を使う
- 知りたい関数から`()`を除いたものを、`help()`の中に入れる
- 例えば、`log()`について知りたいなら`help(log)`と書いて実行
- すると、Rstudioの右下（左下ではない！）のペーンに詳細が表示される

---

## データ型のキホン

- 次の２つの変数に対して`+ 1`という演算を実行してみよう

```{r eval = FALSE}
suuji <- 2 
suuji + 1 

moji <- "岡田先生ステキ"
moji + 1
```

- ひとつ目は`3`という結果を得るが、ふたつ目はエラーが出て処理できない
- この理由を考えてみよう
- `suuji`に格納された`2`というデータは、数字の型（`numeric`ないし`double`）を持っている    
- `moji`に格納された文字列のデータは、文字列の型（`character`）を持っている  
- `character`型のデータに対しては、`+`を使った演算が定義されていないからエラーが出た  
- このように、`+`のような演算子や関数は、特定のデータ型に対してしか使えない
- データ型を確認するには`typeof()`か`mode()`の関数を使う

```{r}
typeof(suuji)
typeof(moji)
```

- 他によく使うデータ型には真偽値（TRUEとFALSE）をあつかう`logical`がある
- データ型についての詳しい説明は[逆瀬川先生のホームページ内のコチラ](http://www.f.waseda.jp/sakas/R/Rdata.html)を参照

##### 練習問題 {-} 
- 上の`suuji`と`moji`について、`mode(suuji)`と`mode(moji)`を実行する
- `typeof(suuji)`と`mode(suuji)`の結果を比較する

---

## 演習問題  

- `zemi`という名前のプロジェクトの中に、`exercise_ch3.R`というRスクリプトを作りなさい
- `exercise_ch3.R`に、以下の問題に答るためのコードを書きなさい

**基本問題：**  <br>

1. `abs(-5)`の結果を確認する
1. `x <- exp(10)`とした上で、`log(x)`の結果を確認  

**挑戦問題：**  <br>

1. `round(0.45, 1)`が`0.5`ではなく`0.4`になることを確認する  
（IEEE式の四捨五入では、末尾が偶数になるように5を丸める）
1. `floor(0.45 * 10)/10`で、通常の四捨五入（`0.5`）になることを確認する  
（xに対し、小数点以下y桁となるように通常の四捨五入をするには`floor(x * 10^y + 0.5)/10^y`）


[^1]: 厳密にはRで出てくるあらゆるモノはオブジェクトだが、ここでは深く踏みこまない

```{r eval = FALSE, include = FALSE}
round(0.45, 1)
floor(0.45*10+0.5)/10
floor(0.445*10^2+0.5)/10^2
abs(-5)
x <- exp(10)
log(x)
```