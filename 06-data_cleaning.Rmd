```{r include = FALSE}
library(tidyverse)
```

# データの前処理

- 本章の説明がわからない人は、森知晴先生のすばらしい動画たちを参考にしよう！
1. [データフレームの操作 in R](https://youtu.be/96AZJmGNass)  

## 前処理

- 集めたデータを分析ができる形に加工することを「前処理」という
- 地味だけど、「データ分析の８割は前処理」と言われるくらい大事な作業
- 本章では、[以前導入した`tidyverse`のパッケージ][パッケージのインストール]を使った前処理のキホンを説明
- まずは以下のコードを実行して`tidyverse`を呼び出そう[^1]

```{r}
library(tidyverse)
```

## パイプによる処理

- `tidyverse`を呼び出すと、パイプ演算子(`%>%`)と呼ばれるものが使えるようになる[^2] [^3]
- パイプを使いこなせるととても便利！（Rが化ける！）
- 例えば、`x`というベクトルの平均を求めるには、次のようにすればよかった
```{r}
x <- c(-1,-2,-3,-4,-5)

mean(x)
```
- 同じことを、パイプを使って以下のように書ける

```{r}
x %>% mean()
```

- 要するに、**引数をパイプで繋いで関数の中に入れてあげているイメージ**
- ベクトルだけでなく、**どんなものでもパイプで繋げられる**
- 例えば、前章で作った`df`というデータフレームの中身を、パイプを使って確認しよう

```{r include=FALSE}
name <- c("Tanaka", "Suzuki", "Okada", "Watanabe")
age <- c(10, 18, 36, 23) #年齢のベクトルの作成
height <- c(149.5, 153.0, 171.0, 174.5)
weight <- c(36, 48, 58, 65)
gender <- c("male", "female", "male", "male") 
df <- data.frame(name, age, height, weight, gender)
```

```{r}
df %>% head() #データフレームもパイプで繋げられる
```

- 関数同士をパイプで繋ぐこともできる

```{r}
read.csv("data/sokutei.csv") %>% head() 
```

- また、**パイプはいくらでも繋げられる**
- 結果を変数に格納することもできる

```{r}
mean_x <- 
  x %>% 
  abs() %>% #xの各要素の絶対値をとった
  mean()　　#絶対値をとったベクトルの平均を計算

mean_x
```

- **どんなものの処理でも、いくらで簡単に繋げられる**のがパイプのすごいところ！
- このあとデータの前処理で使ってみると、パイプの便利さがわかるはず


[^1]: エラーが出る場合は、[以前の章][パッケージのインストール]を参考にパッケージが正しくインストールされているか確認しよう
[^2]: 厳密には、`tidyverse`にも含まる`magrittr`パッケージを呼び出すと使えるようになる
[^3]: Rのver4.1.0以降は、`tidyverse`がなくてもパイプ（`|>`）が使えるようになったが、現在主流の`%>%`の説明をする